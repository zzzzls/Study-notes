<!-- TOC -->

- [多任务概述](#%e5%a4%9a%e4%bb%bb%e5%8a%a1%e6%a6%82%e8%bf%b0)
  - [什么是多任务?](#%e4%bb%80%e4%b9%88%e6%98%af%e5%a4%9a%e4%bb%bb%e5%8a%a1)
  - [CPU如何实现多任务？](#cpu%e5%a6%82%e4%bd%95%e5%ae%9e%e7%8e%b0%e5%a4%9a%e4%bb%bb%e5%8a%a1)
  - [串行，并行，并发](#%e4%b8%b2%e8%a1%8c%e5%b9%b6%e8%a1%8c%e5%b9%b6%e5%8f%91)
    - [串行 Serial](#%e4%b8%b2%e8%a1%8c-serial)
    - [并行 Parallel](#%e5%b9%b6%e8%a1%8c-parallel)
    - [并发 Concurrent](#%e5%b9%b6%e5%8f%91-concurrent)
  - [同步，异步](#%e5%90%8c%e6%ad%a5%e5%bc%82%e6%ad%a5)
    - [同步](#%e5%90%8c%e6%ad%a5)
    - [异步](#%e5%bc%82%e6%ad%a5)
  - [备注](#%e5%a4%87%e6%b3%a8)

<!-- /TOC -->

# 多任务概述

很多同学都听说过，现在操作系统比如 Windows，Linux，Unix，Mac OS 等，都是支持 **多任务** 的操作系统！

## 什么是多任务?

简单地说，就是操作系统可以同时运行多个任务。打个比方，你一边在用浏览器上网，一边在听MP3，一边在用Word写作业，这就是多任务。

## CPU如何实现多任务？

现在，多核CPU已经非常普及了，但是，即使过去的单核CPU，也可以执行多任务。由于CPU指定代码都是顺序执行的，那么，单核CPU是怎么执行多任务的呢？

答案就是操作系统**轮流让各个任务交替执行**，任务1执行0.01秒，切换到任务2，任务2执行0.01秒，在切换到任务3 ... 这样反复执行下去。表面上看，每个任务都是交替执行的，但是，由于CPU的执行速度实在是太快了，我们**感觉就像是所有任务都在同时执行**一样！

真正的并行执行多任务只能在多核CPU上实现，但是，由于任务数量远远多于CPU的核心数量，所以，操作系统也会自动把很多任务轮流调度到每个核心上执行。

## 串行，并行，并发

### 串行 Serial

- 多任务某一时刻只能有一个任务在运行，执行时一个任务执行完再执行另一个
- 比喻：吃完饭在看视频

### 并行 Parallel

- 每个线程分配给独立的核心，多个线程在同一时刻同时运行
- 比喻：一边吃饭一边看电视

### 并发 Concurrent

- 并发指的是通过操作系统的各种任务调度算法（如[时间片轮巡](https://zh.wikipedia.org/wiki/%E6%97%B6%E9%97%B4%E7%89%87)），实现宏观上多个任务 “一起” 执行
  
- 并发在微观上不是同时执行的，只是把时间分成若干段，使多个进程快速交替的执行，由于切换的速度相当快，从宏观上来看，好像是这些进程都在执行，即 **"微观串行，宏观并发"**。并发的实质是一个物理CPU(也可以多个物理CPU) 在若干道程序之间多路复用，并发性是对有限物理资源强制行使多用户共享以提高效率

- 比喻: 一会跑去厨房吃饭，一会跑去客厅看电视

> **并发与并行串行并不是互斥的概念**，在单核CPU上，每一时刻仅能有一个程序执行，所以并发只能是分时地交替执行，倘若在多核CPU上启用并发，那么程序的执行就可以是既并发又并行的。

![img][img@1]

## 同步，异步

### 同步

在发出一个功能调用时，没有得到结果之前，该调用就不返回，程序也不会接着往下执行。按照这个定义，其实绝大多数函数都是同步调用。

![img][img@2]

### 异步

当一个异步过程调用发出后，调用者不能立刻得到结果。实际处理这个调用的部件在完成后，通过状态、通知和回调（Handler机制）来通知调用者。

![img][img@3]


## 备注

> 串行，并行和并发（与硬件结合）：说的是软件的运行过程，在计算机内存中加载了数据，由CPU执行数据运算的程序运行过程。

> 同步和异步（与软件结合）：说的是软件中代码的执行方式，细化到函数的调用过程，宏观到多个业务的执行流程。

[img@1]:https://raw.githubusercontent.com/zzzzls/Images/master/Study_nodes_img/%E5%A4%9A%E4%BB%BB%E5%8A%A1%E6%A6%82%E8%BF%B0/04-25_01.png
[img@2]:https://raw.githubusercontent.com/zzzzls/Images/master/Study_nodes_img/%E5%A4%9A%E4%BB%BB%E5%8A%A1%E6%A6%82%E8%BF%B0/04-25_02.png
[img@3]:https://raw.githubusercontent.com/zzzzls/Images/master/Study_nodes_img/%E5%A4%9A%E4%BB%BB%E5%8A%A1%E6%A6%82%E8%BF%B0/04-25_03.png